<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VistralAI - Database Schema</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;



const Component = () => {
  const [selectedCollection, setSelectedCollection] = useState(null);

  const collections = {
    user: {
      name: 'User',
      icon: 'üë§',
      color: '#3B82F6',
      fields: [
        { name: 'id', type: 'string', key: 'PK' },
        { name: 'email', type: 'string', key: 'UK' },
        { name: 'password', type: 'string' },
        { name: 'accountType', type: 'string' },
        { name: 'subscription', type: 'string' },
        { name: 'mfaEnabled', type: 'boolean' },
        { name: 'onboardingCompleted', type: 'boolean' },
        { name: 'createdAt', type: 'datetime' }
      ],
      relations: ['BrandProfile', 'Session', 'Membership']
    },
    brandProfile: {
      name: 'BrandProfile',
      icon: 'üè¢',
      color: '#10B981',
      fields: [
        { name: 'id', type: 'string', key: 'PK' },
        { name: 'userId', type: 'string', key: 'FK' },
        { name: 'brandName', type: 'string' },
        { name: 'domain', type: 'string' },
        { name: 'category', type: 'string' },
        { name: 'crawlingStatus', type: 'string' }
      ],
      relations: ['BrandIdentity', 'MarketPosition', 'CompetitorProfile', 'ProductDetail']
    },
    brand360Profile: {
      name: 'Brand360Profile',
      icon: 'üéØ',
      color: '#8B5CF6',
      fields: [
        { name: 'id', type: 'string', key: 'PK' },
        { name: 'organizationId', type: 'string', key: 'FK' },
        { name: 'brandName', type: 'string' },
        { name: 'completionScore', type: 'int' },
        { name: 'entityHealthScore', type: 'int' },
        { name: 'lastAnalyzedAt', type: 'datetime' }
      ],
      relations: ['CustomerPersona', 'Product', 'GeneratedPrompt', 'PerceptionScan', 'PerceptionInsight']
    },
    perceptionScan: {
      name: 'PerceptionScan',
      icon: 'üìà',
      color: '#F59E0B',
      fields: [
        { name: 'id', type: 'string', key: 'PK' },
        { name: 'brand360Id', type: 'string', key: 'FK' },
        { name: 'status', type: 'string' },
        { name: 'platforms', type: 'string[]' },
        { name: 'overallScore', type: 'float' },
        { name: 'quadrantPosition', type: 'string' }
      ],
      relations: ['AIPerceptionResult']
    },
    aiPerceptionResult: {
      name: 'AIPerceptionResult',
      icon: 'ü§ñ',
      color: '#EC4899',
      fields: [
        { name: 'id', type: 'string', key: 'PK' },
        { name: 'promptId', type: 'string', key: 'FK' },
        { name: 'brand360Id', type: 'string', key: 'FK' },
        { name: 'platform', type: 'string' },
        { name: 'response', type: 'string' },
        { name: 'faithfulnessScore', type: 'float' },
        { name: 'shareOfVoice', type: 'float' },
        { name: 'hallucinationScore', type: 'float' }
      ],
      relations: []
    },
    generatedPrompt: {
      name: 'GeneratedPrompt',
      icon: 'üìù',
      color: '#14B8A6',
      fields: [
        { name: 'id', type: 'string', key: 'PK' },
        { name: 'brand360Id', type: 'string', key: 'FK' },
        { name: 'category', type: 'string' },
        { name: 'intent', type: 'string' },
        { name: 'template', type: 'string' },
        { name: 'renderedPrompt', type: 'string' }
      ],
      relations: ['AIPerceptionResult']
    },
    subscription: {
      name: 'Subscription',
      icon: 'üí≥',
      color: '#EF4444',
      fields: [
        { name: 'id', type: 'string', key: 'PK' },
        { name: 'userId', type: 'string', key: 'FK' },
        { name: 'stripeCustomerId', type: 'string' },
        { name: 'stripeSubscriptionId', type: 'string' },
        { name: 'status', type: 'string' },
        { name: 'currentPeriodEnd', type: 'datetime' }
      ],
      relations: []
    },
    onboardingSession: {
      name: 'OnboardingSession',
      icon: 'üìã',
      color: '#6366F1',
      fields: [
        { name: 'id', type: 'string', key: 'PK' },
        { name: 'userId', type: 'string', key: 'FK' },
        { name: 'currentStep', type: 'int' },
        { name: 'completedSteps', type: 'int[]' },
        { name: 'selectedTierId', type: 'string' },
        { name: 'subscriptionId', type: 'string' }
      ],
      relations: ['OnboardingEvent']
    }
  };

  const relationships = [
    { from: 'user', to: 'brandProfile', type: '1:1', label: 'has' },
    { from: 'user', to: 'subscription', type: '1:1', label: 'has' },
    { from: 'user', to: 'onboardingSession', type: '1:1', label: 'has' },
    { from: 'brandProfile', to: 'brand360Profile', type: '1:1', label: 'extends' },
    { from: 'brand360Profile', to: 'perceptionScan', type: '1:N', label: 'has many' },
    { from: 'brand360Profile', to: 'generatedPrompt', type: '1:N', label: 'has many' },
    { from: 'perceptionScan', to: 'aiPerceptionResult', type: '1:N', label: 'contains' },
    { from: 'generatedPrompt', to: 'aiPerceptionResult', type: '1:N', label: 'generates' }
  ];

  const keyColors = { PK: '#22C55E', FK: '#3B82F6', UK: '#F59E0B' };

  return (
    <div style={{ minHeight: '100vh', background: 'linear-gradient(180deg, #0C0F1A 0%, #131825 50%, #0C0F1A 100%)', padding: '24px 16px', fontFamily: "'Inter', -apple-system, BlinkMacSystemFont, sans-serif" }}>
      <div style={{ textAlign: 'center', marginBottom: '24px' }}>
        <h1 style={{ fontSize: '24px', fontWeight: '700', color: '#F8FAFC', margin: '0 0 6px 0' }}>VistralAI Database Schema</h1>
        <p style={{ fontSize: '12px', color: '#64748B', margin: '0 0 12px 0' }}>MongoDB Collections & Relationships (ERD)</p>
        <div style={{ display: 'flex', justifyContent: 'center', gap: '12px' }}>
          {Object.entries(keyColors).map(([key, color]) => (
            <div key={key} style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
              <span style={{ background: color, color: 'white', fontSize: '8px', fontWeight: '700', padding: '2px 6px', borderRadius: '4px' }}>{key}</span>
              <span style={{ color: '#64748B', fontSize: '9px' }}>{key === 'PK' ? 'Primary Key' : key === 'FK' ? 'Foreign Key' : 'Unique'}</span>
            </div>
          ))}
        </div>
      </div>

      <div style={{ maxWidth: '1400px', margin: '0 auto' }}>
        {/* Collections Grid */}
        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(240px, 1fr))', gap: '12px', marginBottom: '24px' }}>
          {Object.entries(collections).map(([key, col]) => (
            <div key={key} onClick={() => setSelectedCollection(selectedCollection === key ? null : key)} style={{ background: '#1A1F2E', borderRadius: '10px', border: `2px solid ${selectedCollection === key ? col.color : col.color + '40'}`, overflow: 'hidden', cursor: 'pointer', transition: 'all 0.2s' }}>
              <div style={{ background: `${col.color}20`, padding: '10px 12px', borderBottom: `1px solid ${col.color}30`, display: 'flex', alignItems: 'center', gap: '8px' }}>
                <span style={{ fontSize: '18px' }}>{col.icon}</span>
                <span style={{ color: col.color, fontSize: '13px', fontWeight: '700' }}>{col.name}</span>
              </div>
              <div style={{ padding: '8px' }}>
                {col.fields.map((field, idx) => (
                  <div key={idx} style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '4px 6px', background: idx % 2 === 0 ? '#0F172A' : 'transparent', borderRadius: '4px', marginBottom: '2px' }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                      {field.key && (
                        <span style={{ background: keyColors[field.key], color: 'white', fontSize: '6px', fontWeight: '700', padding: '1px 4px', borderRadius: '2px' }}>{field.key}</span>
                      )}
                      <span style={{ color: '#E2E8F0', fontSize: '10px', fontWeight: '500' }}>{field.name}</span>
                    </div>
                    <span style={{ color: '#64748B', fontSize: '9px', fontFamily: 'monospace' }}>{field.type}</span>
                  </div>
                ))}
              </div>
              {col.relations.length > 0 && (
                <div style={{ padding: '6px 8px', borderTop: '1px solid #334155', background: '#0F172A' }}>
                  <div style={{ color: '#64748B', fontSize: '8px', marginBottom: '4px' }}>RELATIONS</div>
                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px' }}>
                    {col.relations.map((rel, idx) => (
                      <span key={idx} style={{ background: '#334155', color: '#94A3B8', fontSize: '8px', padding: '2px 6px', borderRadius: '4px' }}>{rel}</span>
                    ))}
                  </div>
                </div>
              )}
            </div>
          ))}
        </div>

        {/* Relationships */}
        <div style={{ background: '#1A1F2E', borderRadius: '12px', padding: '16px', border: '1px solid #334155' }}>
          <div style={{ color: '#94A3B8', fontSize: '11px', fontWeight: '600', marginBottom: '12px' }}>COLLECTION RELATIONSHIPS</div>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '8px' }}>
            {relationships.map((rel, idx) => (
              <div key={idx} style={{ background: '#0F172A', borderRadius: '6px', padding: '10px', display: 'flex', alignItems: 'center', gap: '10px' }}>
                <div style={{ background: collections[rel.from].color + '20', borderRadius: '4px', padding: '4px 8px' }}>
                  <span style={{ fontSize: '12px' }}>{collections[rel.from].icon}</span>
                  <span style={{ color: collections[rel.from].color, fontSize: '10px', fontWeight: '600', marginLeft: '4px' }}>{collections[rel.from].name}</span>
                </div>
                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
                  <span style={{ color: '#64748B', fontSize: '8px' }}>{rel.label}</span>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }}>
                    <span style={{ color: '#F59E0B', fontSize: '9px', fontWeight: '700' }}>{rel.type}</span>
                    <svg width="20" height="8"><line x1="0" y1="4" x2="14" y2="4" stroke="#475569" strokeWidth="2" /><polygon points="14,1 20,4 14,7" fill="#475569" /></svg>
                  </div>
                </div>
                <div style={{ background: collections[rel.to].color + '20', borderRadius: '4px', padding: '4px 8px' }}>
                  <span style={{ fontSize: '12px' }}>{collections[rel.to].icon}</span>
                  <span style={{ color: collections[rel.to].color, fontSize: '10px', fontWeight: '600', marginLeft: '4px' }}>{collections[rel.to].name}</span>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};

    ReactDOM.createRoot(document.getElementById("root")).render(<Component />);
  </script>
</body>
</html>
