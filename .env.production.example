# VistralAI Production Environment Configuration
# Copy to .env.production and fill in actual values for production deployment

# ============================================================================
# Core Application Configuration
# ============================================================================

NODE_ENV=production
NEXT_TELEMETRY_DISABLED=1

# ============================================================================
# Authentication (NextAuth.js)
# ============================================================================

# URL where the application is hosted (MUST match Cloud Run service URL)
# Example: https://vistralai-abc123.run.app
NEXTAUTH_URL=https://your-production-url.run.app

# Secret for signing JWT tokens
# Generate with: openssl rand -base64 32
# Store in Google Secret Manager as "nextauth-secret"
NEXTAUTH_SECRET=nextauth-secret

# ============================================================================
# Feature Flags (Control feature rollout)
# ============================================================================

# Enable real Firecrawl service for website crawling
USE_FIRECRAWL=true

# Enable real Claude API calls (vs mock data fallback)
USE_REAL_API=true

# ============================================================================
# AI & LLM Configuration
# ============================================================================

# Claude model to use for brand intelligence extraction
# Options: claude-sonnet-4-20250514, claude-opus-4-1, claude-haiku-3-5
CLAUDE_MODEL=claude-sonnet-4-20250514

# Anthropic API key for Claude access
# Store in Google Secret Manager as "anthropic-api-key"
ANTHROPIC_API_KEY=anthropic-api-key

# Confidence threshold for extraction review (0-1 scale)
# Extractions below this threshold are routed to manual review
CONFIDENCE_THRESHOLD=0.85

# ============================================================================
# Website Crawling Configuration (Firecrawl)
# ============================================================================

# Internal URL for Firecrawl service
# Production: http://firecrawl-service:3000 (Cloud Run internal DNS)
# Local: http://localhost:3002 (docker-compose)
FIRECRAWL_INTERNAL_URL=http://firecrawl-service:3000

# Maximum pages to crawl per domain
FIRECRAWL_MAX_PAGES=20

# Maximum depth for crawling (0 = homepage only, 1 = homepage + links, etc)
FIRECRAWL_MAX_DEPTH=2

# Timeout for each crawl request (milliseconds)
FIRECRAWL_TIMEOUT_MS=30000

# ============================================================================
# Queue System Configuration
# ============================================================================
# Uses in-memory job queue (Bull + Redis support has been removed)

# ============================================================================
# Database Configuration (Future: PostgreSQL)
# ============================================================================

# Database URL for PostgreSQL (currently using mock in-memory database)
# Format: postgresql://user:password@host:port/database
# DATABASE_URL=postgresql://user:password@localhost:5432/vistralai

# ============================================================================
# Logging & Monitoring
# ============================================================================

# Log level for application logs
LOG_LEVEL=info

# Enable structured JSON logging
LOG_FORMAT=json

# Google Cloud project ID (for logging, monitoring integration)
GCP_PROJECT_ID=your-gcp-project-id

# ============================================================================
# Performance & Limits
# ============================================================================

# Maximum request size (bytes)
MAX_REQUEST_SIZE=10485760

# Request timeout (seconds)
REQUEST_TIMEOUT=60

# API rate limiting (requests per minute per IP)
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_MS=60000

# ============================================================================
# Email Configuration (Future: Notifications)
# ============================================================================

# Email service for sending notifications
# SENDGRID_API_KEY=sg_test_key

# From email address
# EMAIL_FROM=noreply@vistralai.com

# ============================================================================
# Third-party Integrations
# ============================================================================

# Sentry error tracking (optional, for production monitoring)
# SENTRY_DSN=https://key@sentry.io/project-id

# Google Analytics (optional, for usage analytics)
# GA_MEASUREMENT_ID=G-XXXXXXXXXX

# ============================================================================
# Security
# ============================================================================

# CORS allowed origins (comma-separated)
# Example: https://vistralai.com,https://admin.vistralai.com
CORS_ORIGINS=https://your-production-url.run.app

# Session cookie secure flag (always true in production)
SESSION_COOKIE_SECURE=true

# Session cookie SameSite setting
SESSION_COOKIE_SAMESITE=Strict

# ============================================================================
# Debugging (Keep disabled in production)
# ============================================================================

# Enable debug logging
DEBUG=false

# Verbose error messages (disabled in production)
VERBOSE_ERRORS=false

# ============================================================================
# Notes for Production Deployment
# ============================================================================
#
# 1. SECRETS: Store sensitive values in Google Secret Manager:
#    - NEXTAUTH_SECRET
#    - ANTHROPIC_API_KEY
#
# 2. VPC SETUP: Ensure Cloud Run VPC connector is configured:
#    - vistralai-connector: Connects VistralAI to Memorystore Redis
#
# 3. MEMORYSTORE: Redis instance must be running:
#    - Instance: vistralai-redis (1GB, Redis 7.0)
#    - Network: Same VPC as Cloud Run
#    - Access: Private (VPC-native only)
#
# 4. FIRECRAWL: Firecrawl service must be deployed:
#    - Service: firecrawl-service on Cloud Run
#    - URL: http://firecrawl-service:3000 (internal DNS)
#    - Region: Same as VistralAI
#
# 5. ENVIRONMENT VARIABLES: All values above should be set via:
#    gcloud run deploy vistralai \
#      --set-env-vars KEY=value \
#      --set-secrets SENSITIVE_KEY=secret-name:latest \
#      ...
#
# 6. MONITORING: Set up Cloud Monitoring dashboards for:
#    - Error rate and latency
#    - CPU and memory usage
#    - Redis memory and connections
#    - API call counts and costs
#
# 7. ALERTS: Configure Cloud Alerting for:
#    - Error rate > 1%
#    - Response time > 30s
#    - CPU usage > 80%
#    - Redis memory > 80%
#
# 8. LOGGING: Enable Cloud Logging aggregation:
#    - Structured JSON logging
#    - Error sink to Sentry (if configured)
#    - Cost monitoring alerts
#
